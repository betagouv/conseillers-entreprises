!!!
%html{ lang: 'fr' }
  %head
    - if request.path == root_path
      = metamagic
    - else
      = metamagic site: t('app_name'), title: %i[title site], separator: ' | '
    %meta{ name: 'viewport', content: 'width=device-width, initial-scale=1.0' }
    = canonical_tags
    = csrf_meta_tags
    = csp_meta_tag
    = tarteaucitron_script
    = tarteaucitron_script_pages
    = stylesheet_link_tag 'pages', data: { 'turbo-track': 'reload' }
    = stylesheet_link_tag '@gouvfr/dsfr/dist/dsfr.min', data: { 'turbo-track': 'reload' }
    = stylesheet_link_tag 'remixicon/fonts/remixicon', data: { 'turbo-track': 'reload' }
    = stylesheet_link_tag '@gouvfr/dsfr/dist/utility/icons/icons-system/icons-system', data: { 'turbo-track': 'reload' }
    = stylesheet_link_tag '@gouvfr/dsfr/dist/utility/icons/icons-communication/icons-communication', data: { 'turbo-track': 'reload' }
    = javascript_include_tag 'gouvfr-module', type: 'module', data: { 'turbo-track': 'reload' }, nonce: true
    = javascript_include_tag 'gouvfr-nomodule', type: 'text/javascript', nomodule: '', data: { 'turbo-track': 'reload' }, nonce: true
    = javascript_include_tag 'pages', data: { 'turbo-track': 'reload' }, type: "module", nonce: true
    %link{ rel: 'preload', href: 'https://browser.sentry-cdn.com/7.35.0/bundle.min.js', as: 'script', crossorigin: 'anonymous', integrity: "sha384-uwCOEtT/vtuzGz5QiQB6J1L3YFYSbznHZGi3B5Vc6+bnyGS3O9nnDfh6dCvLrQ7X", nonce: true }
    - if in_iframe?
      %meta{ name: 'robots', content: 'noindex' }
      = render 'shared/iframe_resizer'
      - if defined?(@landing) && @landing.present?
        %style= @landing.custom_css

    = render 'favicon'
    = yield :head
    = sentry_script
    = matomo_script

  %body
    = render 'shared/skiplinks'
    = render 'pages/navbar' unless in_iframe?
    = render 'environment_ribbon'
    = render 'user_impersonate'
    %main#content{ role: 'main' }
      -# TODO : à supprimer une fois bascule passée
      - if ENV['DISPLAY_BASCULE_INFO'] == 'true'
        = render 'shared/site_switch_info' unless in_iframe?
      = render 'shared/flashes'

      = content_for?(:content) ? yield(:content) : yield # :content is used by sub-layouts

    = render 'footer', footer_landing_themes: @footer_landing_themes, footer_landing: @footer_landing unless in_iframe?
