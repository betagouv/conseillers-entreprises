.ui.segment.selectable-item
  - path = diagnosis.completed? ? need_path(diagnosis, params.permit(:access_token), highlighted_expert: local_assigns[:highlighted_expert]) : diagnosis_path(diagnosis)
  %a{ href: path }
    %h3.ui.header
      .sub.header= I18n.l(diagnosis.display_date, format: :long)
      - if !diagnosis.completed?
        .diagnosis-step
          .ui.grey.basic.label= t("diagnoses.step#{diagnosis.step}.title")
      = diagnosis.company.name
      .sub.header= diagnosis.facility.commune_name
    - if diagnosis.completed?
      - diagnosis.needs.each do |need|
        - if needs_of_interest.blank? || needs_of_interest.include?(need)
          %h4.ui.header
            = need.subject
            .match-status= status_label(need.status)
            .sub.header
              = need.matches.human_count
              - if need.abandoned?
                .ui.label.basic.orange= t('.last_activity_date', l: l(need.last_activity_at.to_date, format: :long))
    = render 'diagnoses/archive_action', diagnosis: diagnosis
